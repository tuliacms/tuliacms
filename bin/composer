#!/bin/bash
# author Adam Banaszkiewicz

if [ -z "$1" ]
then
    action="-"
else
    action="$1"
fi

composeFile="docker-dev/docker-compose.yml"
workdir="/var/www/html/tuliacms"

function docker_execute() {
    docker exec -it --workdir="$workdir" tulia_www $1
}

function composer_execute() {
    cmd="composer $1"
    docker_execute "$cmd"
}

if [ $action = 'reinstall' ]
then
    sudo rm -rf ./vendor && rm -f ./composer.lock
    composer_execute install
elif [ $action = 'vendor:chown' ]
then
    sudo sudo chown -R $(id -u):$(id -g) ./vendor
    sudo sudo chown $(id -u):$(id -g) ./composer.lock
else
    composer_execute "${@:1}"
fi
